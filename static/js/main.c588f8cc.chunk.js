(this["webpackJsonphabitica-summary"]=this["webpackJsonphabitica-summary"]||[]).push([[0],[,,,,,,,,,,function(e,t,a){e.exports=a(21)},,,,,function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(8),l=a.n(c),o=(a(15),a(1)),s=(a(16),a(6)),i=a.n(s),u=a(2),m=a.n(u),d=a(3),f=a.n(d),E=a(4);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var b=r.a.createElement("path",{fillRule:"evenodd",d:"M10.667 10.667L16 8l-5.333-2.667L8 0 5.333 5.333 0 8l5.333 2.667L8 16z"}),v=function(e){var t=e.svgRef,a=e.title,n=p(e,["svgRef","title"]);return r.a.createElement("svg",h({width:16,height:16,viewBox:"0 0 16 16",ref:t},n),a?r.a.createElement("title",null,a):null,b)},y=r.a.forwardRef((function(e,t){return r.a.createElement(v,h({svgRef:t},e))}));a.p,a(19);function w(e){var t,a=Object(n.useContext)(I),c=["task-icon-container","center-wrapper",j(e.task)].join(" "),l=Array((t=e.task.priority,Math.ceil(t/.5))).fill(r.a.createElement(y,{fill:"white","aria-hidden":!0}));return a.showTaskIcons?r.a.createElement("div",{className:c},l):null}var O=[-16,-9,-1,1,6,12],N=["worst","worse","bad","neutral","good","better"];function j(e){for(var t=0;t<O.length;t++)if(e.value<O[t])return N[t];return"best"}function S(e){var t=Object(n.useContext)(I),a=Object(n.useState)(!1),c=Object(o.a)(a,2),l=c[0],s=c[1];return r.a.createElement("section",{className:"dailys"},r.a.createElement("table",null,r.a.createElement("tr",null,r.a.createElement("th",null,r.a.createElement("div",{className:"section-header"},r.a.createElement("h2",null,"Dailies"),r.a.createElement("div",{role:"button",className:"show-no-history clickable",title:"Show/Hide dailies with no data",onClick:function(){return s(!l)}},l?r.a.createElement(E.a,{"aria-hidden":"true"}):r.a.createElement(E.b,{"aria-hidden":"true"})))),t.dates.map((function(e){return r.a.createElement("th",null,r.a.createElement("div",{className:"date-heading"},r.a.createElement("span",null,e.format("MM")),r.a.createElement("span",null,e.format("DD"))))}))),e.data.map((function(e){return r.a.createElement(g,{showNoHistory:l,daily:e})}))),r.a.createElement("div",{className:"link show-no-history",onClick:function(){return s(!l)}}))}function g(e){var t=Object(n.useContext)(I),a=new Map,c=e.daily,l=c.text,o=c.history;f.a.debug(l);for(var s=0;s<o.length;s++){var i=void 0;i=0===s?o[s].value:o[s].value-o[s-1].value;var u=m()(o[s].date);if(f.a.debug(u.format("YYYY-MM-DD HH:mm:ss")+": "+o[s].value),0!==i){t.cronIntervals.search(u.unix(),u.unix()).length>0&&(u=u.subtract(1,"day"));var d=u.format(P);a.has(d)&&f.a.debug("Found date conflict for task ".concat(l," on ").concat(d)),a.set(d,i)}}var E=t.dates.map((function(e){return e.format(P)})).map((function(e){return a.get(e)}));return 0!==E.filter((function(e){return void 0!==e})).length||e.showNoHistory?r.a.createElement("tr",null,r.a.createElement("td",{className:"task-name-row"},r.a.createElement(w,{task:e.daily}),r.a.createElement("span",{className:"task-name"},l)),E.map((function(e){return r.a.createElement(k,{delta:e})}))):null}function k(e){var t,a=["daily-cell"];return e.delta&&0!==e.delta?e.delta>0?(a.push("success"),t="\u2713"):(a.push("fail"),t="\u2716"):(a.push("pass"),t="\xa0"),r.a.createElement("td",{className:a.join(" ")},t&&r.a.createElement("div",{className:"center-wrapper"},r.a.createElement("span",{className:"symbol"},t)))}var T=a(9);function C(e){var t=Object(n.useContext)(I),a=Object(n.useState)(!1),c=Object(o.a)(a,2),l=c[0],s=c[1];return r.a.createElement("section",{className:"habits"},r.a.createElement("table",null,r.a.createElement("tr",null,r.a.createElement("th",null,r.a.createElement("div",{className:"section-header"},r.a.createElement("h2",null,"Habits"),r.a.createElement("div",{role:"button",className:"show-no-history clickable",title:"Show/Hide habits with no data",onClick:function(){return s(!l)}},l?r.a.createElement(E.a,{"aria-hidden":"true"}):r.a.createElement(E.b,{"aria-hidden":"true"})))),t.dates.map((function(e){return r.a.createElement("th",null,r.a.createElement("div",{className:"date-heading"},r.a.createElement("span",null,e.format("MM")),r.a.createElement("span",null,e.format("DD"))))}))),e.data.map((function(e){return r.a.createElement(D,{showNoHistory:l,habit:e})}))))}function D(e){var t=Object(n.useContext)(I),a=new Map,c=e.habit,l=c.text,o=c.history;f.a.debug(l);var s,i=Object(T.a)(o);try{for(i.s();!(s=i.n()).done;){var u=s.value,d=m()(u.date).format(P);f.a.debug(JSON.stringify(u)),void 0!==u.scoredUp&&void 0!==u.scoredDown&&a.set(d,[u.scoredUp,u.scoredDown])}}catch(h){i.e(h)}finally{i.f()}var E=t.dates.map((function(e){return e.format(P)})).map((function(e){return a.get(e)}));return 0!==E.filter((function(e){return void 0!==e})).length||e.showNoHistory?r.a.createElement("tr",null,r.a.createElement("td",{className:"task-name-row"},r.a.createElement(w,{task:e.habit}),r.a.createElement("span",{className:"task-name"},l)),E.map((function(e){return e?r.a.createElement(R,{up:e[0],down:e[1]}):r.a.createElement("td",{className:"habit-cell"},"\xa0")}))):null}function R(e){return r.a.createElement("td",{className:"habit-cell"},r.a.createElement("div",{className:"habit-score-container"},e.up>0&&r.a.createElement("div",{className:"success center-wrapper"},r.a.createElement("span",null,"+",e.up)),e.down>0&&r.a.createElement("div",{className:"fail center-wrapper"},r.a.createElement("span",null,"-",e.down))))}a(20);function A(e){var t=Object(n.useContext)(I).dates[0],a=e.data.filter((function(e){return m()(e.dateCompleted).isAfter(t)}));return r.a.createElement("section",{className:"todos"},r.a.createElement("h2",null,"Completed Todos"),r.a.createElement("ul",null,a.map((function(e){return r.a.createElement(x,{todo:e})}))))}function x(e){var t=m()(e.todo.dateCompleted).format("MMM D");return r.a.createElement("li",{className:"todo-row"},r.a.createElement(w,{task:e.todo}),r.a.createElement("span",{className:"todo-date"},t),r.a.createElement("div",{className:"todo-content"},r.a.createElement("div",{className:"todo-text"},e.todo.text),e.todo.notes&&r.a.createElement("div",{className:"todo-notes"},e.todo.notes)))}var I=r.a.createContext({showTaskIcons:!0,dates:Array(),cronIntervals:new i.a});function H(e){var t=Object(n.useState)(!0),a=Object(o.a)(t,2),c=a[0],l=a[1],s=Object(n.useState)(!0),u=Object(o.a)(s,2),d=u[0],f=u[1],E=Object(n.useState)(!0),h=Object(o.a)(E,2),p=h[0],b=h[1],v=Object(n.useState)(7),y=Object(o.a)(v,2),w=y[0],O=y[1],N=Object(n.useState)(!0),j=Object(o.a)(N,2),g=j[0],k=j[1],T=Object(n.useState)([]),D=Object(o.a)(T,2),R=D[0],x=D[1],H=Object(n.useState)([]),P=Object(o.a)(H,2),F=P[0],U=P[1],Y=Object(n.useState)([]),L=Object(o.a)(Y,2),G=L[0],B=L[1],J=Object(n.useState)([]),K=Object(o.a)(J,2),W=K[0],z=K[1],$=e.userId,q=e.userApiKey,Q=function(e){return fetch(e,{method:"GET",headers:{"Content-Type":"application/json","x-api-user":$,"x-api-key":q,"x-client":"0d9428fd-d6fa-45f3-a4db-f130e3ef10ea-HabiticaSummaryTool"}})},V=function(e){if(!e.success)throw new Error(e.message);return e},X=e.setError;if(Object(n.useEffect)((function(){Q("https://habitica.com/api/v3/user").then((function(e){return e.json()})).then(V).then((function(e){x(e.data.history.exp.map((function(e){var t=m()(e.date);return[t.unix()-60,t.unix()+60]}))),l(!1)}),(function(e){X(e)}))}),[]),Object(n.useEffect)((function(){Q("https://habitica.com/api/v3/tasks/user").then((function(e){return e.json()})).then(V).then((function(e){U(e.data.filter((function(e){return"habit"===e.type}))),B(e.data.filter((function(e){return"daily"===e.type}))),f(!1)}),(function(e){X(e)}))}),[]),Object(n.useEffect)((function(){Q("https://habitica.com/api/v3/tasks/user?type=completedTodos").then((function(e){return e.json()})).then(V).then((function(e){z(e.data.filter((function(e){return"todo"===e.type}))),b(!1)}),(function(e){X(e)}))}),[]),c||d||p)return r.a.createElement("div",{className:"App"},r.a.createElement("p",null,"Loading..."));e.setAppState(M.DATA_FETCH_SUCCESS);var Z=new i.a;R.forEach((function(e){return Z.insert(e[0],e[1],!0)}));var ee,te={showTaskIcons:g,dates:(ee=w,Array(ee).fill(0).map((function(e,t){return t+1})).reverse().map((function(e){return m()().subtract(e,"days").startOf("day")}))),cronIntervals:Z};return r.a.createElement("div",{className:"App"},r.a.createElement(I.Provider,{value:te},r.a.createElement(_,{numDaysToShow:w,setNumDaysToShow:O,toggleTaskIcons:function(){return k(!g)}}),r.a.createElement(C,{data:F}),r.a.createElement(S,{data:G}),r.a.createElement(A,{data:W})))}function _(e){var t=Object(n.useContext)(I);return r.a.createElement("div",{className:"show-more-toggle"},r.a.createElement("span",{role:"button",className:"link",onClick:function(){return e.setNumDaysToShow(e.numDaysToShow+7)}},"+1 week"),r.a.createElement("span",{role:"button",className:"link",onClick:e.toggleTaskIcons,title:"Show/Hide task icons"},t.showTaskIcons?"Hide":"Show"," Task Icons"),e.numDaysToShow>7?r.a.createElement("span",{role:"button",className:"link",onClick:function(){return e.setNumDaysToShow(e.numDaysToShow-7)}},"-1 week"):null)}var M,P="YYYYMMDD";!function(e){e[e.PROMPT_FOR_USER_CREDS=0]="PROMPT_FOR_USER_CREDS",e[e.FETCHING_DATA=1]="FETCHING_DATA",e[e.DATA_FETCH_SUCCESS=2]="DATA_FETCH_SUCCESS",e[e.ERROR=3]="ERROR"}(M||(M={}));var F=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(""),s=Object(o.a)(l,2),i=s[0],u=s[1],m=Object(n.useState)(),d=Object(o.a)(m,2),f=d[0],E=d[1],h=Object(n.useState)(M.PROMPT_FOR_USER_CREDS),p=Object(o.a)(h,2),b=p[0],v=p[1];return b===M.PROMPT_FOR_USER_CREDS||b===M.ERROR?r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"Habitica Summary Tool"),f&&r.a.createElement("div",{className:"error"},"Error: ",f.message),r.a.createElement("p",null,"This tool displays a weekly summary of your Habits, Dailies and Todos in Habitica."),r.a.createElement("p",null,"Your User ID and API key can be found on the"," ",r.a.createElement("a",{href:"https://habitica.com/user/settings/api",target:"_blank",rel:"noopener noreferrer"},"Settings > API")," ","page in Habitica."),r.a.createElement("form",{className:"user-api-form"},r.a.createElement("div",{className:"label-container"},r.a.createElement("div",{className:"label"},"User ID"),r.a.createElement("input",{type:"text",className:"user-id",value:a,onChange:function(e){c(e.target.value)}})),r.a.createElement("div",{className:"label-container"},r.a.createElement("span",{className:"label"},"API Key"),r.a.createElement("input",{type:"password",className:"api-key",value:i,onChange:function(e){u(e.target.value)},minLength:36})),r.a.createElement("div",{className:"submit-wrapper"},r.a.createElement("input",{type:"submit",value:"Fetch My Data",onClick:function(e){e.preventDefault(),v(M.FETCHING_DATA)}}))),r.a.createElement("h2",null,"Note"),r.a.createElement("ul",null,r.a.createElement("li",null,"Your user ID and API key will be sent to the Habitica servers and nowhere else."),r.a.createElement("li",null,"This app does not change your Habitica account data. It only fetches and displays data."))):r.a.createElement(H,{userId:a,userApiKey:i,setError:function(e){E(e),v(M.ERROR)},setAppState:v})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement("div",{className:"app-wrapper"},r.a.createElement(F,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[10,1,2]]]);
//# sourceMappingURL=main.c588f8cc.chunk.js.map